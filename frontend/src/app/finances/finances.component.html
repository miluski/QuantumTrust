<div
  class="flex-col flex justify-center text-center bg-black text-white w-full"
>
  <div class="flex flex-col justify-center items-center">
    <div class="relative flex flex-row space-x-5">
      <p class="font-walter text-3xl text-white">Lista kont</p>
      <div
        class="relative rounded-full w-8 h-8 bg-gray-500 hover:bg-gray-400 cursor-pointer mt-1 inline-block items-center justify-center"
        matTooltip="Otwórz nowe konto."
        (click)="changeTabName('AuthorizedOpenAccount')"
      >
        <hr
          class="absolute top-[50%] left-[10%] bg-black border-none shadow-none w-6 h-0.5"
        />
        <hr
          class="absolute top-[50%] left-[10%] bg-black border-none shadow-none w-6 h-0.5 rotate-90"
        />
      </div>
    </div>
    <div class="flex flex-row w-screen sm:space-x-10 relative justify-center">
      @if(accountsPaginationService.totalPages > 1) {
      <div class="absolute inset-y-1/2 flex items-center z-10 w-screen">
        <button
          [ngClass]="{ hidden: accountsPaginationService.currentPage <= 1 }"
          class="sm:ml-10 font-bold py-2 px-4 rounded-l text-white max-sm:px-2"
          (click)="accountsPaginationService.previousPage()"
        >
          <mat-icon class="cursor-pointer">arrow_back</mat-icon>
        </button>
        <div class="flex-grow"></div>
        <button
          [ngClass]="{
            hidden:
              accountsPaginationService.currentPage ===
              accountsPaginationService.totalPages
          }"
          class="font-bold py-2 rounded-r text-white sm:mr-2 px-4 max-sm:px-2"
          (click)="accountsPaginationService.nextPage()"
        >
          <mat-icon class="cursor-pointer">arrow_forward</mat-icon>
        </button>
      </div>
      } @for(account of accountsPaginationService.paginatedItems; track
      account.id) {
      <div
        class="flex flex-col bg-gray-500 hover:bg-gray-400 rounded-3xl cursor-pointer p-3 max-sm:p-2"
        (click)="
          setSelectedAccount(account);
          changeTabName('SingleAccountTransactions')
        "
      >
        <div
          class="relative justify-between flex flex-row w-full h-full items-center space-x-5 mb-5"
        >
          <p
            class="font-roboto font-medium max-sm:text-lg text-2xl text-white pt-5"
          >
            Konto
            {{ convertService.getPolishAccountType(account.type) }}
          </p>
          <app-image
            class="max-sm:w-16 max-sm:h-14 w-28 h-24"
            ownClass="rounded-2xl border border-black pointer-events-none h-full w-full"
            [src]="account.image"
            alt="single-account-image"
          />
        </div>
        <p class="font-roboto font-normal max-sm:text-sm text-xl text-black">
          {{ account.id }}
        </p>
        <div class="flex flex-row space-x-2">
          <p class="font-roboto font-normal max-sm:text-sm text-xl text-black">
            Saldo:
          </p>
          <p
            class="font-roboto font-normal max-sm:text-sm text-xl text-green-500"
          >
            {{
              convertService.getNumberWithSpacesBetweenThousands(
                account.balance ?? 0
              )
            }}
            {{ account.currency }}
          </p>
        </div>
      </div>
      } @if(accountsPaginationService.paginatedArray === undefined ||
      accountsPaginationService.paginatedArray.length === 0) {
      <div
        class="flex flex-col bg-gray-500 w-[80%] rounded-3xl cursor-pointer p-5"
      >
        <p
          class="font-roboto font-normal max-sm:text-lg text-2xl text-black text-nowrap"
        >
          Nie posiadasz żadnego konta!
        </p>
      </div>
      }
    </div>
  </div>
  <div class="justify-center items-center max-sm:w-screen">
    <div class="flex flex-col text-center items-center justify-center w-full">
      <div
        class="flex flex-col xxl:flex-row justify-between w-[85%] xxl:w-full space-y-10"
      >
        <div></div>
        <div class="flex flex-col">
          <p class="font-walter text-3xl text-white text-nowrap">Lista lokat</p>
          <div
            class="flex flex-col bg-gray-500 rounded-3xl md:px-12 md:py-5 pt-5 h-full justify-center"
          >
            @for(deposit of userDeposits; track deposit.id) {
            <div class="flex flex-row max-lg:flex-col justify-between">
              <div class="flex flex-col items-center lg:items-start">
                <p class="font-roboto font-light text-2xl text-white sm:pt-5">
                  Lokata {{ convertService.getPolishDepositType(deposit.type) }}
                </p>
                <p
                  class="font-roboto font-normal max-sm:text-sm text-xl text-black"
                >
                  {{ deposit.id }}
                </p>
              </div>
              <div class="flex flex-row items-center justify-center">
                <p
                  class="font-roboto font-normal max-sm:text-2xl text-3xl text-black self-center md:pt-5 px-10"
                >
                  {{ deposit.percent }}%
                </p>
                <p
                  class="font-roboto font-medium max-sm:text-lg text-xl text-green-500 self-center p-5"
                >
                  {{
                    convertService.getNumberWithSpacesBetweenThousands(
                      deposit.balance ?? 0
                    )
                  }}
                  {{ deposit.currency }}
                </p>
              </div>
            </div>
            } @if(userDeposits === undefined || userDeposits.length === 0) {
            <div
              class="flex p-5 text-center justify-center items-center w-full sm:px-40"
            >
              <p
                class="font-roboto font-normal max-sm:text-lg text-lg p-3 text-black self-center"
              >
                Nie posiadasz żadnej lokaty!
              </p>
            </div>
            }
            <button
              class="border border-white text-white font-salsa rounded-lg py-2 px-1 hover:text-black hover:border-black self-center mb-10 text-nowrap sm:mt-5"
              (click)="changeTabName('OpenDeposit')"
            >
              Otwórz lokatę
            </button>
          </div>
        </div>
        <div class="flex flex-col max-sm:w-full">
          <p class="font-walter text-3xl text-white text-nowrap">
            Ostatnie transakcje
          </p>
          <div
            class="flex flex-col bg-gray-500 rounded-3xl h-full justify-center"
          >
            @for(transactionArray of dailyTransactions; track transactionArray)
            { @if(transactionArray[0]) {
            <p
              class="self-start font-roboto font-normal text-2xl text-black pt-3 pl-3"
            >
              {{ getDayAndMonthFromDate(transactionArray[0].date) }}
            </p>
            } @for(transaction of transactionArray; track transaction.id) {
            <div
              class="flex flex-row justify-between md:space-x-20 self-start w-full pt-5"
            >
              <div class="flex flex-col pl-5 max-sm:w-[20%]">
                <p
                  class="font-roboto text-white font-light text-lg max-sm:text-sm max-sm:text-start"
                >
                  {{ transaction.hour }}
                </p>
                <i
                  class="fa-solid {{
                    convertService.getIconClassFromTransactionCategory(
                      transaction.category
                    )
                  }} text-black self-start px-2 lg:px-5"
                ></i>
              </div>
              <div
                class="flex flex-col text-start self-start sm:w-1/3 max-sm:w-[40%]"
              >
                <p
                  class="font-roboto text-white font-light text-md max-sm:text-sm max-sm:text-center text-nowrap max-sm:text-wrap"
                >
                  {{ transaction.category }}
                </p>
                <p
                  class="font-roboto text-white font-light text-base max-sm:text-sm max-sm:text-center text-nowrap"
                >
                  ****
                  {{ getShortenedAccountNumber(transaction) }}
                </p>
              </div>
              <div class="flex flex-col text-end pr-5 sm:w-1/3 max-sm:w-[40%]">
                <p
                  class="font-roboto font-medium text-md max-sm:text-sm text-nowrap"
                  [ngClass]="{
                    'text-green-500': transaction.type === 'incoming',
                    'text-red-500': transaction.type === 'outgoing'
                  }"
                >
                  {{ transaction.type === "incoming" ? "+" : "-" }}
                  {{
                    convertService.getNumberWithSpacesBetweenThousands(
                      transaction.amount
                    )
                  }}
                  {{ transaction.currency }}
                </p>
                <p
                  class="font-roboto font-light text-sm text-black w-full mr-5 text-nowrap"
                >
                  {{
                    convertService.getNumberWithSpacesBetweenThousands(
                      transaction.accountAmountAfter
                    )
                  }}
                  {{ transaction.accountCurrency }}
                </p>
              </div>
            </div>
            } } @if(dailyTransactions[0] === undefined) {
            <div class="flex text-center justify-center items-center py-5">
              <p
                class="font-roboto font-normal max-sm:text-lg text-lg p-3 text-black self-center"
              >
                Nie zrealizowano żadnych transakcji w ciągu ostatnich 2 dni!
              </p>
            </div>
            }
            <button
              class="border border-white text-white font-salsa rounded-lg py-2 px-1 hover:text-black hover:border-black self-center mb-10 text-nowrap mt-5"
              (click)="changeTabName('NewTransfer')"
            >
              Nowy przelew
            </button>
          </div>
        </div>
        <div></div>
      </div>
    </div>
  </div>
  <div class="flex flex-col justify-center items-center pt-5">
    <div class="relative flex flex-row space-x-5">
      <p class="font-walter text-3xl text-white">Moje karty</p>
      <div
        class="relative rounded-full w-8 h-8 bg-gray-500 hover:bg-gray-400 cursor-pointer mt-1 inline-block items-center justify-center"
        matTooltip="Zamów nową kartę."
        (click)="changeTabName('OrderCard')"
      >
        <hr
          class="absolute top-[50%] left-[10%] bg-black border-none shadow-none w-6 h-0.5"
        />
        <hr
          class="absolute top-[50%] left-[10%] bg-black border-none shadow-none w-6 h-0.5 rotate-90"
        />
      </div>
    </div>
    <div
      class="flex flex-row w-screen h-full lg:space-x-14 relative justify-center"
    >
      @if(cardPaginationService.totalPages > 1) {
      <div class="absolute inset-t-30-b-50 flex items-center z-10 w-screen">
        <button
          [ngClass]="{ hidden: cardPaginationService.currentPage <= 1 }"
          class="sm:ml-10 font-bold px-4 py-20 rounded-l text-white max-sm:px-2"
          (click)="cardPaginationService.previousPage()"
        >
          <mat-icon class="cursor-pointer">arrow_back</mat-icon>
        </button>
        <div class="flex-grow"></div>
        <button
          [ngClass]="{
            hidden:
              cardPaginationService.currentPage ===
              cardPaginationService.totalPages
          }"
          class="font-bold py-2 rounded-r text-white sm:mr-2 px-4 max-sm:px-2"
          (click)="cardPaginationService.nextPage()"
        >
          <mat-icon class="cursor-pointer">arrow_forward</mat-icon>
        </button>
      </div>
      } @for(card of cardPaginationService.paginatedItems; track card.id) {
      <div class="flex flex-col relative mb-5 z-30"
        [ngClass]="{'pl-20': card.site === 'back'}">
        <div
          class="flex flex-col relative cursor-pointer z-30 w-full h-full max-sm:w-[95%]"
          [@rotateCard]="card.showingCardSite"
          (click)="
            card.showingCardSite =
              card.showingCardSite === 'front' ? 'back' : 'front'
          "
        >
          <app-image
            ownClass="object-cover shadow-gray-400 shadow-sm rounded-2xl pointer-events-none w-full h-full max-sm:h-44 max-sm:!w-[265px] w-80 h-48 my-10 z-10"
            [ngClass]="{ 'opacity-50': card.status === 'suspended' }"
            [src]="
              card.showingCardSite === 'front' ? card.image : card.backImage
            "
            alt="user-single-card"
          />
          @if(card.showingCardSite === 'front') {
          <div
            class="absolute top-10 left-2 flex flex-row items-center p-2 bg-opacity-75 rounded-md z-20"
          >
            <app-image
              class="w-4 h-4 pointer-events-none"
              src="favicon.ico"
              alt="Quantum Trust Logo"
            />
            <p
              [ngClass]="{
                'text-black': card.image === 'mastercard-standard.webp'
              }"
              class="font-salsa text-xs leading-none pt-2 pl-2"
            >
              Quantum Trust
            </p>
          </div>
          <p
            class="font-courier text-xl text-silver text-shadow absolute z-20 max-sm:text-lg"
            [ngClass]="{
              'sm:pb-2 bottom-20 left-7 sm:left-10': card.publisher === 'Visa',
              'bottom-16 pb-2 left-3': card.publisher === 'Mastercard'
            }"
          >
            {{ card.id | cardIdFormat }}
          </p>
          <p
            class="font-courier text-md text-silver text-shadow absolute z-20"
            [ngClass]="{
              'bottom-8 pb-5 max-sm:pb-5 left-32 max-sm:left-28 pl-2':
                card.publisher === 'Visa',
              'bottom-4 pb-7 left-3': card.publisher === 'Mastercard'
            }"
          >
            {{ card.expirationDate }}
          </p>
          <p
            class="font-courier text-sm text-silver text-shadow absolute z-20"
            [ngClass]="{
              'sm:pb-2 bottom-8 max-sm:pb-2 left-8 sm:left-10':
                card.publisher === 'Visa',
              'bottom-4 pb-4 left-3.5': card.publisher === 'Mastercard'
            }"
          >
            {{ userService.userFullName }}
          </p>
          } @if(card.showingCardSite === 'back') {
          <p
            class="absolute font-roboto font-normal text-xs text-black top-24 z-30 counter-rotate"
            [ngClass]="{
              'pt-2 max-sm:!left-[100px] max-sm:pt-1 left-[125px]':
                card.publisher === 'Visa',
              'pt-3.5 max-sm:!left-24 max-sm:pt-2.5 left-28 pr-2 max-sm:pr-1':
                card.publisher === 'Mastercard'
            }"
          >
            {{ card.cvcCode }}
          </p>
          }
          <i
            class="absolute top-14 fa-solid fa-gear text-brown hover:text-light-brown text-2xl cursor-pointer z-30"
            [ngClass]="{
              'left-2': card.showingCardSite === 'back',
              'sm:right-2 max-sm:right-0 max-sm:ml-5': card.showingCardSite === 'front'
            }"
            (click)="setSelectedCard(card); changeTabName('CardSettings')"
            matTooltip="Zmień ustawienia karty."
          ></i>
        </div>
        <div class="flex flex-row w-full space-x-5 justify-center z-50">
          <p class="font-roboto font-normal text-2xl text-own-gray">
            {{ card.publisher }} {{ card.type.toLocaleLowerCase() }}
          </p>
          <i
            class="fa-solid fa-circle-exclamation pt-2"
            [ngClass]="{ hidden: card.status !== 'suspended' }"
            matTooltip="Karta została zawieszona."
          ></i>
        </div>
      </div>
      } @if(cardPaginationService.paginatedArray === undefined ||
      cardPaginationService.paginatedArray.length === 0) {
      <div
        class="flex flex-col bg-gray-500 w-[80%] rounded-3xl cursor-pointer p-5 mb-5 items-center justify-center text-center"
      >
        <p
          class="font-roboto font-normal max-sm:text-lg text-2xl text-black text-nowrap"
        >
          Nie posiadasz żadnej karty!
        </p>
      </div>
      }
    </div>
  </div>
</div>
